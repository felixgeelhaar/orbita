---
title: Calendar Sync
description: Multi-provider bi-directional calendar synchronization with Google, Microsoft, Apple, and CalDAV.
---

import { Steps, Aside, Card, CardGrid, Tabs, TabItem } from '@astrojs/starlight/components';

# Calendar Sync

Orbita provides **bi-directional calendar synchronization** with multiple providers, keeping your external calendars and Orbita schedule in perfect alignment.

<Aside type="tip" title="New in v0.4.0">
  Multi-provider calendar support is now available! Connect Google, Microsoft Outlook, Apple Calendar, and any CalDAV server simultaneously.
</Aside>

## Supported Providers

<CardGrid>
  <Card title="Google Calendar" icon="google">
    OAuth2 authentication with full read/write access to Google Calendar.
  </Card>
  <Card title="Microsoft Outlook" icon="seti:outlook">
    Microsoft 365 and personal Outlook accounts via Microsoft Graph API.
  </Card>
  <Card title="Apple Calendar" icon="apple">
    iCloud CalDAV with app-specific password authentication.
  </Card>
  <Card title="CalDAV" icon="server">
    Generic CalDAV for Fastmail, Nextcloud, and self-hosted calendars.
  </Card>
</CardGrid>

## How It Works

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    MULTI-PROVIDER BI-DIRECTIONAL SYNC                     │
└─────────────────────────────────────────────────────────────────────────┘

               Orbita                              External Calendars
    ┌─────────────────────┐               ┌─────────────────────────────┐
    │                     │   Push        │  Google Calendar            │
    │  Task Created       │──────────────►│  Microsoft Outlook          │
    │  Block Added        │               │  Apple Calendar (iCloud)    │
    │                     │               │  CalDAV (Fastmail, etc.)    │
    │                     │   Pull        │                             │
    │  Block Updated      │◄──────────────│  External events imported   │
    │  Conflict Found     │               │  across all providers       │
    └─────────────────────┘               └─────────────────────────────┘
```

### Push Sync (Orbita → Calendars)

When you create tasks, habits, or meetings in Orbita:
1. Orbita automatically schedules them
2. Scheduled blocks push to your connected calendars
3. Calendar events include Orbita metadata for tracking

### Pull Sync (Calendars → Orbita)

When external events are added or modified:
1. Orbita detects changes via periodic polling
2. External events appear as blocked time
3. Conflicts are detected and resolved automatically

## Connecting Calendar Providers

Use the `orbita auth` commands to manage calendar connections.

<Tabs>
  <TabItem label="Google">
    ```bash
    orbita auth connect google
    ```
    Opens your browser for OAuth authentication with Google.
  </TabItem>
  <TabItem label="Microsoft">
    ```bash
    orbita auth connect microsoft
    ```
    Opens your browser for OAuth authentication with Microsoft (works with both personal and work/school accounts).
  </TabItem>
  <TabItem label="Apple">
    ```bash
    orbita auth connect apple
    ```
    Prompts for your Apple ID and an **app-specific password**.

    <Aside type="note">
      You need to generate an app-specific password at [appleid.apple.com](https://appleid.apple.com/account/manage) under "Sign-In and Security" > "App-Specific Passwords".
    </Aside>
  </TabItem>
  <TabItem label="CalDAV">
    ```bash
    orbita auth connect caldav --url https://caldav.example.com
    ```
    Prompts for username and password. Works with:
    - Fastmail: `https://caldav.fastmail.com`
    - Nextcloud: `https://your-server/remote.php/dav`
    - Other CalDAV servers
  </TabItem>
</Tabs>

### Connection Options

```bash
orbita auth connect <provider> [flags]
  --name string     Display name for the calendar
  --primary         Set as primary calendar for imports
  --push            Enable pushing Orbita blocks (default: true)
  --pull            Enable pulling external events (default: false)
  --url string      CalDAV server URL (required for caldav provider)
```

## Managing Connections

### List Connected Calendars

```bash
orbita auth list
```

Output:
```
Connected Calendars:
  ✓ google     felix@example.com      [primary] [push] [pull]
  ✓ microsoft  felix@company.com                [push]
  ✓ caldav     Personal (Fastmail)              [push]
```

### Disconnect a Calendar

```bash
orbita auth disconnect <provider>
```

Example:
```bash
orbita auth disconnect microsoft
# Output: Disconnected Microsoft calendar.
```

## Syncing

### Sync to All Calendars

```bash
orbita sync --all
```

Output:
```
Syncing 5 blocks to 3 calendars...
  google:    ✓ created=2 updated=1 deleted=0
  microsoft: ✓ created=2 updated=1 deleted=0
  caldav:    ✓ created=2 updated=1 deleted=0
```

### Sync to Specific Provider

```bash
orbita sync --provider microsoft
```

Output:
```
Syncing 5 blocks to Microsoft...
  created=2 updated=1 deleted=0
```

### Sync Status

```bash
orbita sync --status
```

Output:
```
Calendar Sync Status
═══════════════════════
Connected Calendars: 3
Last Sync: 2 minutes ago
Sync Interval: 5 minutes
Next Sync: 3 minutes

Statistics (Last 24h):
  Events Pushed: 8
  Events Pulled: 3
  Conflicts Resolved: 1
  Pending Conflicts: 0
```

## Configuration

### Sync Settings

```yaml
# ~/.orbita/config.yaml
calendar:
  sync_enabled: true
  sync_interval: "5m"        # Check every 5 minutes
  look_ahead_days: 14        # Sync 2 weeks ahead

  # What to auto-schedule
  auto_schedule:
    tasks: true
    habits: true
    meetings: true
```

### Conflict Resolution

When Orbita blocks conflict with external events:

```yaml
calendar:
  conflict_strategy: time_first  # Default

  # Options:
  # - orbita_wins: Keep Orbita blocks, reschedule if needed
  # - external_wins: External events take priority
  # - time_first: Earlier scheduled item wins
  # - manual: Mark for review, no auto-resolution
```

<Tabs>
  <TabItem label="orbita_wins">
    Orbita blocks take priority. If an external event conflicts:
    - Orbita block stays at its time
    - External event is marked as conflict
    - You're notified to handle manually
  </TabItem>
  <TabItem label="external_wins">
    External events take priority. If conflict occurs:
    - Orbita block is automatically rescheduled
    - New optimal slot is found
    - You're notified of the change
  </TabItem>
  <TabItem label="time_first">
    First-scheduled wins:
    - If Orbita block was scheduled first, it stays
    - If external event was first, Orbita reschedules
    - Fair resolution for both systems
  </TabItem>
  <TabItem label="manual">
    No automatic resolution:
    - Conflicts are flagged for review
    - Use `orbita conflicts show` to see them
    - Resolve manually with `orbita conflicts resolve`
  </TabItem>
</Tabs>

## Viewing Synced Events

```bash
# Show schedule with external events
orbita schedule show --include-external

# View only external events
orbita schedule show --external-only
```

Output:
```
Schedule for Monday, January 20, 2025

09:00 - 10:00  Prepare presentation [task]
10:30 - 11:00  Client Call [external] ← From Google Calendar
12:00 - 13:00  Lunch [break]
14:00 - 14:30  Daily standup [meeting]
15:00 - 16:00  Team Planning [external] ← From Microsoft Outlook
```

## Conflict Management

### Viewing Conflicts

```bash
orbita conflicts show
```

Output:
```
Pending Conflicts (1)
═════════════════════

#1 OVERLAP
  Orbita Block: "Deep work session" (10:00 - 12:00)
  External Event: "Urgent team meeting" (11:00 - 12:00)
  Source: Microsoft Outlook
  Detected: 5 minutes ago

  Resolution Options:
  [R] Reschedule Orbita block
  [K] Keep both (overlap allowed)
  [D] Delete external event
  [I] Ignore (mark as resolved)
```

### Resolving Conflicts

```bash
# Resolve interactively
orbita conflicts resolve

# Auto-resolve all
orbita conflicts resolve --auto

# Resolve specific conflict
orbita conflicts resolve 1 --action reschedule
```

## Primary Calendar

Set one calendar as primary for event imports:

```bash
# Set primary during connection
orbita auth connect google --primary

# Or update later
orbita settings set calendar.primary google
```

The primary calendar is used when:
- Importing events without specifying a source
- Checking availability across all calendars
- Default destination for quick-add events

## Push and Pull Settings

Each connected calendar can be configured for:

| Setting | Description |
|---------|-------------|
| **Push** | Send Orbita blocks to this calendar |
| **Pull** | Import external events from this calendar |

```bash
# Enable both push and pull
orbita auth connect google --push --pull

# Push only (don't clutter Orbita with external events)
orbita auth connect microsoft --push --no-pull
```

## Event Properties

### Orbita Events in External Calendars

When Orbita syncs to your calendar, events include:

- **Title**: Task/habit/meeting name
- **Description**: Notes and metadata
- **Color**: Based on type (task, habit, meeting)
- **Extended Properties**: Orbita IDs for tracking

<Aside>
  Don't modify Orbita-created events directly in your external calendar. Changes may be overwritten on next sync.
</Aside>

### External Events in Orbita

External events appear as blocked time:

```bash
orbita schedule show
```

```
09:00 - 10:00  Prepare presentation [task]
10:30 - 11:00  Client Call [external]
               └─ Source: Google Calendar (Work)
               └─ Attendees: john@company.com, sarah@company.com
15:00 - 16:00  Team Planning [external]
               └─ Source: Microsoft Outlook
```

## Troubleshooting

### Connection Issues

```bash
# Check connection status
orbita auth list

# Re-authenticate a provider
orbita auth connect google --force

# View sync logs
orbita logs --component calendar
```

### Sync Not Working

<Steps>
1. Verify calendars are connected
   ```bash
   orbita auth list
   ```

2. Check sync is enabled
   ```bash
   orbita config show calendar
   ```

3. Force a manual sync
   ```bash
   orbita sync --all --verbose
   ```

4. Check for errors
   ```bash
   orbita logs --level error
   ```
</Steps>

### Duplicate Events

If you see duplicate events:

```bash
# Clean up duplicates
orbita calendar cleanup --duplicates

# Reset sync state for a provider
orbita calendar reset --provider google
```

<Aside type="caution">
  `calendar reset` removes all sync state for that provider. Events will be re-synced on next sync cycle.
</Aside>

## Privacy & Security

### Data Handling

- OAuth tokens stored locally in `~/.orbita/tokens/`
- CalDAV credentials encrypted at rest
- Calendar data cached temporarily during sync
- No data sent to third-party servers

### Permissions Required

| Provider | Permissions |
|----------|-------------|
| Google | Read/write calendar events |
| Microsoft | Calendars.ReadWrite |
| Apple | CalDAV access (via app-specific password) |
| CalDAV | Basic authentication |

### Revoking Access

```bash
# Disconnect from Orbita
orbita auth disconnect <provider>

# Additionally revoke from provider settings:
# Google: https://myaccount.google.com/permissions
# Microsoft: https://account.microsoft.com/privacy/app-access
# Apple: Remove app-specific password from Apple ID settings
```

## Best Practices

1. **Start with one calendar** - Add more once basic sync works
2. **Use push-only for work calendars** - Avoid cluttering Orbita with all meetings
3. **Set a primary for imports** - Clear source of truth for availability
4. **Review conflicts weekly** - Don't let pending conflicts pile up
5. **Keep buffer time** - External events may not have buffers

## OAuth Configuration (Self-Hosted)

For self-hosted setups, configure your own OAuth credentials:

```bash
# Google
export OAUTH_GOOGLE_CLIENT_ID="your-client-id"
export OAUTH_GOOGLE_CLIENT_SECRET="your-client-secret"

# Microsoft
export OAUTH_MICROSOFT_CLIENT_ID="your-client-id"
export OAUTH_MICROSOFT_CLIENT_SECRET="your-client-secret"
```

See [Configuration](/orbita/docs/getting-started/configuration) for full OAuth setup instructions.

## Next Steps

- [Smart Scheduling](/orbita/docs/features/scheduling) - How scheduling works
- [Conflict Resolution Guide](/orbita/docs/guides/conflict-resolution) - Advanced conflict handling
- [Configuration](/orbita/docs/getting-started/configuration) - Full config options
